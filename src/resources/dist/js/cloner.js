void 0===Craft.Cloner&&(Craft.Cloner={}),function(t){Craft.Cloner=Garnish.Base.extend({$table:null,title:null,action:null,init:function(e){Garnish.requestAnimationFrame(t.proxy((function(){this.$table=t("#"+e.id+"-vue-admin-table"),this.title="New "+e.title+" Name",this.action="cloner/"+e.action,this.setupTable()}),this))},setupTable:function(){var e=this;this.$table.length&&(this.$table.find("thead tr").each((function(){var e=t(this).find("td.thin:first");if(e.length){var n=t('<td class="thin"></td>');e.before(n)}else t(this).append('<td class="thin"></td>')})),this.$table.find("tbody tr").each((function(){var n=t(this).find('td a[role="button"]').parents("td"),a=t('<a class="add icon"></a><span class="spinner cloner-spinner hidden"></span>');if(n.length){var i=t('<td class="thin"></td>').html(a);n.before(i)}else{var i=t('<td class="thin"></td>').html(a);t(this).append(i)}e.addListener(a,"click","onCloneButtonClick")})))},onCloneButtonClick:function(e){e.preventDefault();var n,a,i=t(e.currentTarget).parents("tr").find("td:first a").attr("href").split("/"),r=i[i.length-1],s,l=t(e.currentTarget),d=t(e.currentTarget).siblings(".spinner");if(s=prompt(this.title)){var o={id:r,name:s,handle:this.generateHandle(s)};l.addClass("hidden"),d.removeClass("hidden"),Craft.postActionRequest(this.action,o,t.proxy((function(t,e){t&&t.success?window.location.reload():(Craft.cp.displayError(Craft.t("cloner",t.error)),l.removeClass("hidden"),d.addClass("hidden"))}),this))}},generateHandle:function(t){var e;e=(e=(e=t.replace("/<(.*?)>/g","")).replace(/['"‘’“”\[\]\(\)\{\}:]/g,"")).toLowerCase(),e=(e=Craft.asciiString(e)).replace(/^[^a-z]+/,"");for(var n=Craft.filterArray(e.split(/[^a-z0-9]+/)),e="",a=0;a<n.length;a++)e+=0==a?n[a]:n[a].charAt(0).toUpperCase()+n[a].substr(1);return e}})}(jQuery);
//# sourceMappingURL=cloner.js.map